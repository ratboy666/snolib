; TEST.JIT
;
; TEST JIT ASM (ASSEMBLER/LOADER)
;
         NAME      'SPEED'
;
PRINTF   CEXTERN   'printf'
;
D        RESQ
D2       DQ        5
;
STR      DS        'hello, world %d'
         DB        10
         DB        0
;
LIMIT    EQU       10000000
;
         PROLOG
         NOTE      'COUNT 0..LIMIT', 1
         MOVI      .R1, (LIMIT)        ; LIMIT TO R1
         MOVI      .R2, 0
L        ADDI      .R2, .R2, 1
         BLER      .R2, .R1, L
;
         NOTE      'PRINTF(STR, R2)', 2
         MOVI      .R0, STR            ; PRINTF(STR, R2)
         PUSHARGR  .R0
         ELLIPSIS
         PUSHARGR  .R2
         FINISHI   PRINTF
;
         NOTE      'D = D2', 4
         LDI       .R1, D2
         STI       D, .R1
;
         NOTE      'RETURN R1', 5
         RETR      .R1                 ; RETURN R1
         EPILOG
         END
